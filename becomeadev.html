<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-V622S6G7VF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-V622S6G7VF');
</script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Become a Developer — Application</title>

<meta name="robots" content="noindex, nofollow">
<meta name="theme-color" content="#000000">

<style>
:root{
  --bg:#050505;
  --border:rgba(255,255,255,.08);
  --text:#f5f5f5;
  --muted:#a3a3a3;
  --red:#ef4444;
  --red2:#b91c1c;
}

*{ box-sizing:border-box; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; }

body{
  margin:0;
  min-height:100vh;
  background:
    radial-gradient(800px 400px at 20% 0%, rgba(239,68,68,.18), transparent 60%),
    radial-gradient(circle at top, #141414, var(--bg));
  color:var(--text);
  display:flex;
  align-items:center;
  justify-content:center;
  padding:16px;
}

.container{
  width:100%;
  max-width:840px;
  border:1px solid var(--border);
  border-radius:22px;
  background:rgba(0,0,0,.35);
  padding:22px;
}

h1,h2{ margin:0 0 10px; }
p{ color:var(--muted); line-height:1.6; font-size:14px; }

.hidden{ display:none; }

.warning{
  border:1px solid rgba(239,68,68,.35);
  background:rgba(239,68,68,.08);
  padding:14px;
  border-radius:14px;
  margin-bottom:16px;
}

.btn{
  width:100%;
  padding:14px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.1);
  font-weight:950;
  cursor:pointer;
}
.btn.red{
  background:linear-gradient(135deg,var(--red),var(--red2));
  color:white;
}
.btn.gray{
  background:rgba(255,255,255,.06);
  color:var(--text);
}

.row{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:12px;
}
@media (max-width:760px){
  .row{ grid-template-columns:1fr; }
}

.field label{
  display:block;
  color:var(--muted);
  font-size:12px;
  margin-bottom:6px;
}
.field input{
  width:100%;
  padding:12px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,.12);
  background: rgba(0,0,0,.22);
  color: var(--text);
  outline:none;
}
.field input:focus{
  border-color: rgba(239,68,68,.35);
  box-shadow: 0 0 0 3px rgba(239,68,68,.14);
}

.question{
  margin-top:16px;
  padding:16px;
  border:1px solid var(--border);
  border-radius:16px;
  background:rgba(255,255,255,.03);
}

.answers label{
  display:block;
  margin-top:10px;
  cursor:pointer;
  font-size:14px;
}

.metaBar{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  align-items:center;
  justify-content:space-between;
  margin-top:8px;
  color:var(--muted);
  font-size:12px;
}

.badgeHard{
  display:inline-flex;
  align-items:center;
  gap:6px;
  border:1px solid rgba(239,68,68,.35);
  background: rgba(239,68,68,.10);
  padding:6px 10px;
  border-radius:999px;
  color:#fecaca;
  font-weight:900;
}

.score{
  font-size:20px;
  font-weight:950;
  color:#fecaca;
}
.small{
  font-size:12px;
  color:var(--muted);
}
</style>
</head>

<body>
<div class="container">

  <!-- LOCKED SCREEN -->
  <div id="lockedScreen" class="hidden">
    <h1 style="color:#ef4444;">Application Locked</h1>
    <p>You cannot retake this application on this device/browser.</p>
  </div>

  <!-- WARNING / START SCREEN -->
  <div id="warningScreen">
    <h1>⚠️ Developer Application</h1>

    <div class="warning">
      <p>
        This is a <b>one-time application</b>.
        <br><br>
        • If you <b>change tabs, minimize, or leave this page</b> after starting, the application ends and you <b>cannot take it again</b>.
        <br>
        • Any <b>signs of AI assistance</b>, copying, or outside help may result in a <b>blacklist</b>.
        <br>
        • Score + answers + timing + basic behavior signals are logged.
      </p>
    </div>

    <p>Enter your info to begin:</p>

    <div class="row">
      <div class="field">
        <label>Discord Username (example: name or name#0000)</label>
        <input id="discordUser" placeholder="yourname" maxlength="40" />
      </div>
      <div class="field">
        <label>Discord ID (numbers only)</label>
        <input id="discordId" placeholder="123456789012345678" inputmode="numeric" maxlength="25" />
      </div>
    </div>

    <p class="small" style="margin-top:10px;">
      This test has <b>20 HTML questions</b> (3 are <b>really hard</b>).
    </p>

    <button class="btn red" onclick="startTest()">Start</button>
  </div>

  <!-- TEST SCREEN -->
  <div id="testScreen" class="hidden">
    <h2 id="progress"></h2>
    <div class="metaBar">
      <div id="hardTag" class="hidden badgeHard">⚠ HARD</div>
      <div id="timerText">Time: 0s</div>
    </div>
    <div id="questionBox"></div>
    <button class="btn gray" onclick="nextQuestion()">Next</button>
  </div>

  <!-- RESULT SCREEN -->
  <div id="resultScreen" class="hidden">
    <h1>Application Submitted</h1>
    <p class="score" id="scoreText"></p>
    <p>Your results were sent for review.</p>
  </div>

</div>

<script>
const WEBHOOK = "https://discord.com/api/webhooks/1464366500738760887/jP8FA6F1m9-uh-KUnbh92vHH4Fiv28MbalyTAdXFbip4xgr7K5ltvhH3EounmdoRhIW7";
const LOCK_KEY = "devAppLocked_v3";
const ATTEMPT_KEY = "devAppAttempt_v3";

const questions = [
  { hard:false, q:"What does HTML stand for?", a:["Hyper Text Markup Language","High Text Machine Language","Hyper Tool Markup Language"], c:0 },
  { hard:false, q:"Which tag creates a hyperlink?", a:["<a>","<link>","<href>"], c:0 },
  { hard:false, q:"Which tag is used to display an image?", a:["<img>","<image>","<pic>"], c:0 },
  { hard:false, q:"What does the <head> section usually contain?", a:["Metadata (title, meta, links)","Only visible content","Only images"], c:0 },
  { hard:false, q:"Which attribute opens a link in a new tab/window?", a:["target=\"_blank\"","open=\"new\"","rel=\"newtab\""], c:0 },
  { hard:false, q:"Which is the semantic tag for important text (often bold)?", a:["<strong>","<b>","<bold>"], c:0 },
  { hard:false, q:"Which tag is used for an unordered list?", a:["<ul>","<ol>","<list>"], c:0 },
  { hard:false, q:"Which tag inserts a line break?", a:["<br>","<lb>","<break>"], c:0 },
  { hard:false, q:"Which tag is best for a site navigation section?", a:["<nav>","<menu>","<navigate>"], c:0 },
  { hard:false, q:"What is the purpose of the alt attribute on <img>?", a:["Provides text description / accessibility","Changes image color","Makes image load faster"], c:0 },
  { hard:false, q:"Which tag wraps the visible page content?", a:["<html>","<body>","<main>"], c:1 },
  { hard:false, q:"Which input type hides typed characters?", a:["password","hidden","secure"], c:0 },
  { hard:false, q:"Which tag is used to create a form?", a:["<form>","<input>","<fieldset>"], c:0 },
  { hard:false, q:"What does <!DOCTYPE html> do?", a:["Declares HTML document type (standards mode)","Links CSS file","Loads JavaScript"], c:0 },
  { hard:false, q:"Which tag is used for a table row?", a:["<tr>","<td>","<th>"], c:0 },
  { hard:false, q:"Which attribute is required for <label> to connect to an input by id?", a:["for","name","target"], c:0 },
  { hard:false, q:"What is the correct tag for the main page heading?", a:["<h1>","<head>","<title>"], c:0 },
  { hard:true,  q:"(Hard) Which statement about 'void elements' is correct?", a:["They must not have end tags (e.g., <img>, <br>)","They must always have closing tags","They can contain child elements"], c:0 },
  { hard:true,  q:"(Hard) In HTML forms, what does the 'name' attribute on an <input> mainly control?", a:["The key used when the form is submitted","The placeholder text","The element's CSS class"], c:0 },
  { hard:true,  q:"(Hard) Which is true about <script> placement in HTML (without using 'defer'/'async')?", a:["It blocks parsing while it loads/executes","It never blocks parsing","It only blocks CSS, not HTML"], c:0 }
];

// ==== state ====
let index = 0;
let score = 0;
let answers = []; // per question info object
let locked = false;

let userDiscordName = "";
let userDiscordId = "";

let attemptStarted = false;
let startedAt = null;
let endedAt = null;
let endedReason = "Completed";

let tickTimer = null;
let qStartedAt = null;

// behavior signals
let visibilityHiddenCount = 0;
let blurCount = 0;

// prepared randomized answer order per question
let prepared = []; // [{q, hard, correctOriginalIndex, shuffled:[{text, origIndex}]}]

// ==== UI helpers ====
function show(id){
  ["warningScreen","testScreen","resultScreen","lockedScreen"].forEach(x=>{
    document.getElementById(x).classList.add("hidden");
  });
  document.getElementById(id).classList.remove("hidden");
}

(function initLock(){
  if(localStorage.getItem(LOCK_KEY)){
    show("lockedScreen");
  }
  // Pre-build randomized question data once (so it doesn't change mid-test)
  prepared = questions.map((qq) => {
    const shuffled = shuffleArray(qq.a.map((txt, i) => ({ text: txt, origIndex: i })));
    return {
      q: qq.q,
      hard: !!qq.hard,
      correctOriginalIndex: qq.c,
      shuffled
    };
  });
})();

// ==== tab/leave detection ONLY after they start test (after username/id) ====
document.addEventListener("visibilitychange", () => {
  if(document.hidden){
    visibilityHiddenCount++;
    if(attemptStarted && !locked){
      lockApplication("Tab switch / page leave detected");
    }
  }
});

window.addEventListener("blur", () => {
  blurCount++;
  if(attemptStarted && !locked){
    lockApplication("Window lost focus (possible tab switch)");
  }
});

// ==== start ====
function startTest(){
  if(localStorage.getItem(LOCK_KEY)){
    show("lockedScreen");
    return;
  }

  const u = document.getElementById("discordUser").value.trim();
  const id = document.getElementById("discordId").value.trim();

  if(!u || u.length < 2) return alert("Enter your Discord username.");
  if(!id || id.length < 10 || !/^\d+$/.test(id)) return alert("Enter a valid Discord ID (numbers only).");

  userDiscordName = u;
  userDiscordId = id;

  startedAt = new Date();
  localStorage.setItem(ATTEMPT_KEY, "started");

  attemptStarted = true;
  show("testScreen");

  index = 0;
  score = 0;
  answers = [];

  startGlobalTimer();
  renderQuestion();
}

// ==== rendering ====
function renderQuestion(){
  const qq = prepared[index];

  // Ensure always shows
  if(!qq || !qq.q || !Array.isArray(qq.shuffled) || qq.shuffled.length < 2){
    lockApplication("Question render error");
    return;
  }

  // per-question start
  qStartedAt = new Date();

  document.getElementById("progress").textContent = `Question ${index+1} / ${prepared.length}`;

  // hard badge
  const hardTag = document.getElementById("hardTag");
  if(qq.hard){
    hardTag.classList.remove("hidden");
  } else {
    hardTag.classList.add("hidden");
  }

  let html = `<div class="question"><p><b>${escapeHTML(qq.q)}</b></p><div class="answers">`;
  qq.shuffled.forEach((opt, i) => {
    html += `
      <label>
        <input type="radio" name="ans" value="${i}">
        ${escapeHTML(opt.text)}
      </label>`;
  });
  html += `</div></div>`;

  document.getElementById("questionBox").innerHTML = html;
}

// ==== next ====
function nextQuestion(){
  const sel = document.querySelector('input[name="ans"]:checked');
  if(!sel) return alert("Select an answer.");

  const chosenShuffledIndex = parseInt(sel.value, 10);
  const qq = prepared[index];

  if(!qq || !qq.shuffled || !qq.shuffled[chosenShuffledIndex]){
    lockApplication("Answer capture error");
    return;
  }

  const chosen = qq.shuffled[chosenShuffledIndex];
  const isCorrect = (chosen.origIndex === qq.correctOriginalIndex);
  if(isCorrect) score++;

  const qEndedAt = new Date();
  const qTimeMs = qStartedAt ? (qEndedAt - qStartedAt) : null;

  // record lots of info per question
  answers.push({
    number: index + 1,
    hard: qq.hard,
    question: qq.q,
    optionsShown: qq.shuffled.map(o => o.text),
    chosenOptionText: chosen.text,
    chosenOriginalIndex: chosen.origIndex,
    correctOptionText: questions[index].a[questions[index].c],
    correctOriginalIndex: qq.correctOriginalIndex,
    correct: isCorrect,
    timeSeconds: qTimeMs !== null ? Math.max(0, Math.round(qTimeMs/1000)) : null
  });

  index++;
  if(index >= prepared.length){
    finish();
  } else {
    renderQuestion();
  }
}

// ==== finish / lock ====
function finish(){
  locked = true;
  endedReason = "Completed";
  endedAt = new Date();

  localStorage.setItem(LOCK_KEY,"true");
  localStorage.setItem(ATTEMPT_KEY, "ended");

  stopGlobalTimer();

  show("resultScreen");
  document.getElementById("scoreText").textContent = `Score: ${score} / ${prepared.length}`;

  sendWebhook(endedReason);
}

function lockApplication(reason){
  locked = true;
  endedReason = reason;
  endedAt = new Date();

  localStorage.setItem(LOCK_KEY,"true");
  localStorage.setItem(ATTEMPT_KEY, "ended");

  stopGlobalTimer();

  // try to send what we have so far
  sendWebhook(reason);

  alert("Application ended: " + reason);
  show("lockedScreen");
}

// ==== timers ====
function startGlobalTimer(){
  const timerEl = document.getElementById("timerText");
  if(tickTimer) clearInterval(tickTimer);
  tickTimer = setInterval(() => {
    if(!startedAt) return;
    const sec = Math.max(0, Math.round((new Date() - startedAt)/1000));
    timerEl.textContent = `Time: ${sec}s`;
  }, 500);
}
function stopGlobalTimer(){
  if(tickTimer) clearInterval(tickTimer);
  tickTimer = null;
}

// ==== webhook payload (LOTS of info) ====
function sendWebhook(reason){
  const now = new Date();
  const end = endedAt || now;

  const durationMs = startedAt ? (end - startedAt) : null;
  const durationSeconds = durationMs !== null ? Math.max(0, Math.round(durationMs/1000)) : null;

  const env = {
    url: location.href,
    referrer: document.referrer || "none",
    userAgent: navigator.userAgent,
    language: navigator.language,
    platform: navigator.platform || "unknown",
    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone || "unknown",
    screen: `${screen.width}x${screen.height}`,
    viewport: `${window.innerWidth}x${window.innerHeight}`
  };

  const summary = {
    discordUsername: userDiscordName,
    discordId: userDiscordId,
    result: reason,
    score: `${score} / ${prepared.length}`,
    startedAt: startedAt ? startedAt.toISOString() : null,
    endedAt: end ? end.toISOString() : null,
    durationSeconds,
    visibilityHiddenCount,
    blurCount,
    answeredCount: answers.length
  };

  // Create a compact detailed log (Discord embed description has 4096 char limit)
  const detailObj = { summary, env, answers };
  let detailStr = JSON.stringify(detailObj, null, 2);

  // keep under ~3800 chars to be safe
  const MAX_DESC = 3800;
  if(detailStr.length > MAX_DESC){
    detailStr = detailStr.slice(0, MAX_DESC) + "\n... (truncated)";
  }

  const payload = {
    content: null,
    embeds: [{
      title: "New Developer Application",
      color: 15548997,
      fields: [
        { name:"Discord Username", value: safeField(userDiscordName), inline: true },
        { name:"Discord ID", value: safeField(userDiscordId), inline: true },
        { name:"Result", value: safeField(reason) },
        { name:"Score", value: `${score} / ${prepared.length}`, inline: true },
        { name:"Time Taken (sec)", value: durationSeconds !== null ? String(durationSeconds) : "N/A", inline: true },
        { name:"Behavior", value: `visibilityHidden=${visibilityHiddenCount}, blur=${blurCount}`, inline: false }
      ],
      description: "```json\n" + detailStr + "\n```"
    }]
  };

  fetch(WEBHOOK,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify(payload)
  }).catch(()=>{});
}

function safeField(s){
  const t = (s || "N/A").toString();
  return t.length > 1024 ? t.slice(0, 1021) + "..." : t;
}

// ==== utils ====
function escapeHTML(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#39;");
}

function shuffleArray(arr){
  // Fisher–Yates
  const a = arr.slice();
  for(let i=a.length-1; i>0; i--){
    const j = Math.floor(Math.random() * (i+1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}
</script>

</body>
</html>
